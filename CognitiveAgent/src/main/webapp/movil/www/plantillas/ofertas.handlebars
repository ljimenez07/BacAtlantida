<div class="row">
  <div class="col-xs-12">
    <p><strong>¡Hola!</strong></p><br>
    <p>Inicie sesi&oacute;n para que conozcas tus <strong>mejores beneficios</strong></p>
    <br>
  </div>
</div>
<div class="contenedor-de-ofertas">
</div>
{{#compare cantidad ">" 10}}
  <br>
  <div class="row">
    <div class="col-xs-12 text-center">
      <span id="mostrar-mas">Mostrar más</span>
    </div>
  </div>
{{/compare}}

<script type="text/javascript">
var pagina = 1;
cargarOfertas();
pagina++;

$("#mostrar-mas").click(function() {
  $.ajax({
    url: serverDomain + "/ofertas/cantidad",
    async: false,
    success: function(data) {
  	  cargarOfertas();
      var cantidadDeOfertasMostradas = pagina * 10;
      console.log(cantidadDeOfertasMostradas);
      console.log(data);
      console.log(data < cantidadDeOfertasMostradas);
      if(data < cantidadDeOfertasMostradas) {
        $("#mostrar-mas").parent().parent().remove();
      }
    }
  });
  pagina++;
});

function bindAcciones() {
	$(".datos-de-oferta").click(function() {
	  var id = $(this).attr("id");
	  $.ajax({
	    url: serverDomain + "/ofertas/" + id,
	    success: function(data) {
	      $(".panel-body").html(Handlebars.templates.oferta(data));
	    }
	  });
	});
	
	$(".boton-like, .boton-dislike").click(function() {
	  var activo = $(this).parent().parent().find(".activo");
	  if(activo.attr('class') != $(this).attr('class')) {
	    activo.addClass("inactivo").removeClass("activo");
	  }
	  $(this).toggleClass("activo").toggleClass("inactivo");
	});
}

function cargarOfertas() {
  var context;
  $.ajax({
    url: serverDomain + "/ofertas",
    data: {
      pagina: pagina
    },
    async: false,
    success: function(data) {
      context = {ofertas: data};
    }
  });
  $(".contenedor-de-ofertas").append(Handlebars.templates.listaDeOfertas(context));
  bindAcciones();
}
</script>
